var aaiiScreener=function(){"use strict";var e,t=dc.barChart("#returns-chart"),r=dc.barChart("#risk-index-chart"),a=dc.barChart("#std-dev-chart"),s=dc.barChart("#sharpe-ratio-chart"),n=dc.barChart("#turnover-chart"),i={Value:"#8DD3C7","Value With Price Momentum":"#FFFFB3",Growth:"#BEBADA","Growth With Price Momentum":"#FB8072","Growth & Value":"#A6CEE3","Growth & Value With Price Momentum":"#FDB462","Earnings Estimates":"#B3DE69",Indexes:"#FCCDE5","T-Bills":"#D9D9D9","Insider Net Purchases":"#BC80BD"},o=$("#wrapper").width(),c=!1,l=[],h="Annualized Return",d=0,u=0,p=0,g=0,w=0,m=0,f=0,v=!1,k=function(e){var t;return e=e.replace("price chg",""),e=y(e),"Cash Rich Firms"==e?t={url:"http://www.aaii.com/stock-screens/screendata/CashRichFirms",desc:"Locating firms with a high proportion of cash to share price."}:"Dogs of the Dow"==e?t={url:"http://www.aaii.com/stock-screens/screendata/Dogs",desc:"Identifying contrarian plays among the Dow Jones Industrial stocks."}:"Fundamental Rule of Thumb"==e?t={url:"http://www.aaii.com/stock-screens/screendata/FRT",desc:"An old Value screen combining the P/E ratio, dividend yield, and an adjusted return on equity that's still applicable in today's market."}:"Graham--Defensive Investor (Non-Utility)"==e?t={url:"http://www.aaii.com/stock-screens/screendata/GrahamDINon",desc:"Credited as one of the fathers of in-depth security analysis, Graham's approach focuses on the concept of intrinsic Value."}:"Graham--Defensive Investor (Utility)"==e?t={url:"http://www.aaii.com/stock-screens/screendata/GrahamDIU",desc:"Graham's approach leads to three separate that focus on the concept of intrinsic value, justified by a firm's financial strength."}:"Graham--Enterprising Investor"==e?t={url:"http://www.aaii.com/stock-screens/screendata/GrahamEI",desc:"Credited as one of the fathers of in-depth security analysis, Graham's approach focuses on the concept of intrinsic Value."}:"Graham--Enterprising Investor Revised"==e?t={url:"http://www.aaii.com/stock-screens/screendata/GrahamEIR",desc:"Credited as one of the fathers of in-depth security analysis, Graham's approach focuses on the concept of intrinsic Value."}:"Magic Formula"==e?t={url:"http://www.aaii.com/stock-screens/screendata/Magic",desc:"Joel Greenblatt's simple investing approach is based finding companies with high return on investment that are trading for less than they are worth."}:"O'Shaughnessy: Value"==e?t={url:"http://www.aaii.com/stock-screens/screendata/OShauValue",desc:"Value screen created by James O'Shaughnessy that lead to the best risk adjusted return among a wide range of Value approaches."}:"Piotroski: High F-Score (8)"==e?t={url:"http://www.aaii.com/stock-screens/screendata/Piotroski",desc:"A study of low price-to-book Value stocks to see if it's possible to establish basic financial criteria to help separate the winners from the losers."}:"Piotroski 9"==e||("Price-to-Free-Cash-Flow"==e?t={url:"http://www.aaii.com/stock-screens/screendata/PricetoFreeCashFlow",desc:"An exploration of the basics of cash flow analysis and the implementation of a price to free cash flow screen."}:"Schloss"==e?t={url:"http://www.aaii.com/stock-screens/screendata/Schloss",desc:"This screen looks for stocks hitting new lows, trading at a price lower than book Value per share, with no debt and high levels of insider ownership."}:"Dogs of the Dow: Low Priced 5"==e?t={url:"http://www.aaii.com/stock-screens/screendata/DogsLowPriced5",desc:"Identifying contrarian plays among the Dow Jones Industrial stocks."}:"Shadow Stock Screen"==e?t={url:"http://www.aaii.com/model-portfolios/stock",desc:"AAII's model portfolio. Trades occur quarterly to minimize transactions.  Focuses on well-priced micro-cap stocks."}:"Weiss Blue Chip Div Yield"==e?t={url:"http://www.aaii.com/stock-screens/screendata/Weiss",desc:"A conservative, blue-chip investment style with Value approach with an emphasis on selecting stocks with favorable dividend yields."}:"Lakonishok"==e?t={url:"http://www.aaii.com/stock-screens/screendata/Lakonishok",desc:"Identifying stocks trading at a discount to their industry norms but showing recent price strength and upward earnings revisions."}:"O'Shaughnessy: All Cap"==e?t={url:"http://www.aaii.com/stock-screens/screendata/OShauAllCap",desc:"Growth at a reasonable price screen created by James O'Shaughnessy."}:"O'Shaughnessy: Growth"==e?t={url:"http://www.aaii.com/stock-screens/screendata/OShauGrowth",desc:"O'Shaughnessy tries to predict the future using historical long-term trends."}:"O'Shaughnessy: Growth Market Leaders"==e?t={url:"http://www.aaii.com/stock-screens/screendata/OShauGML",desc:"O'Shaughnessy tries to predict the future using historical long-term trends."}:"O'Shaughnessy: Small Cap Growth & Value"==e?t={url:"http://www.aaii.com/stock-screens/screendata/OShauSmallCap",desc:"O'Shaughnessy tries to predict the future using historical long-term trends."}:"O'Shaughnessy: Tiny Titans"==e?t={url:"http://www.aaii.com/stock-screens/screendata/OShauTinyTitans",desc:"O'Shaughnessy tries to predict the future using historical long-term trends."}:"Dual Cash Flow"==e?t={url:"http://www.aaii.com/stock-screens/screendata/DualCashFlow",desc:"An analysis that can provide advance notice a company may be facing financial trouble, though earnings and sales appear strong."}:"IBD Stable 70"==e?t={url:"http://www.aaii.com/stock-screens/screendata/IBD",desc:"The IBD Stable 70 screen has easily outperformed the small-, mid- and large-cap indexes over the last several years."}:"Inve$tWare Quality Growth"==e?t={url:"http://www.aaii.com/stock-screens/screendata/Investware",desc:"The NAIC adopts a simple buy-and-hold, fundamental approach to Growth investing."}:"Return on Equity"==e?t={url:"http://www.aaii.com/stock-screens/screendata/ROE",desc:"A screen that identifies stocks with above earnings and sales growth that have consistently outperformed their peers measured by ROE."}:"Driehaus"==e?t={url:"http://www.aaii.com/stock-screens/screendata/Driehaus",desc:"Classic momentum approach that seeks out stocks that are rapidly rising in price with the belief that the rising price will attract other investors."}:"Foolish Small Cap 8"==e?t={url:"http://www.aaii.com/stock-screens/screendata/Foolish8",desc:"The Motley Fool’s Foolish 8 method for investing in small caps looks for profitable and rapidly growing companies with strong price momentum."}:"Kirkpatrick Growth"==e?t={url:"http://www.aaii.com/stock-screens/screendata/KirkpatrickGrowth",desc:"Investing model outlined in Charles Kirkpatrick's book Beat the Market: Invest by Knowing What Stocks to Buy and What Stocks to Sell."}:"O'Neil's CAN SLIM"==e?t={url:"http://www.aaii.com/stock-screens/screendata/CANSLIM",desc:"An interesting approach that combines both fundamental and technical factors to seek out companies with strong earnings and price momentum."}:"O'Neil's CAN SLIM No Float"==e?t={url:"http://www.aaii.com/stock-screens/screendata/CANSLIMNofloat",desc:"How to implement William O’Neil’s revised CAN SLIM approach to screen for fast-growing stocks."}:"O'Neil's CAN SLIM Revised 3rd Edition"==e?t={url:"http://www.aaii.com/stock-screens/screendata/CANSLIMRev",desc:"How to implement William O’Neil’s revised CAN SLIM approach to screen for fast-growing stocks."}:"Buffett: Hagstrom"==e?t={url:"http://www.aaii.com/stock-screens/screendata/BuffHags",desc:"Hagstrom identifies 12 basic principles that a company should possess to be considered for purchase."}:"Buffettology: EPS Growth"==e?t={url:"http://www.aaii.com/stock-screens/screendata/BuffettologyEPSGrowth",desc:"Buffett approach seeking consumer monopolies selling at a reasonable price."}:"Buffettology: Sustainable Growth"==e?t={url:"http://www.aaii.com/stock-screens/screendata/BuffettologySusGrowth",desc:"Buffett approach seeking consumer monopolies selling at a reasonable price."}:"Dividend (High Relative Yield)"==e?t={url:"http://www.aaii.com/stock-screens/screendata/DividendHighRelativeYield",desc:"Using the dividend-yield approach to invest during volatile markets."}:"Dividend Screen: DRPs"==e?t={url:"http://www.aaii.com/stock-screens/screendata/DRPs",desc:"A screen for stocks with DRPs (dividend reinvestment plans)."}:"Dividend Screen: Non-DRPs"==e?t={url:"http://www.aaii.com/stock-screens/screendata/NonDRPs",desc:"A screen for stocks with DRPs (dividend reinvestment plans)."}:"Dreman"==e?t={url:"http://www.aaii.com/stock-screens/screendata/Dreman",desc:"Avoiding the psychological traps of the market by following the principles of contrarian investing."}:"Fisher (Philip)"==e?t={url:"http://www.aaii.com/stock-screens/screendata/Fisher",desc:"A perspective on the evolution of the investment philosophy of a successful money manager who learned from his mistakes."}:"Foolish Small Cap 8 Revised"==e?t={url:"http://www.aaii.com/stock-screens/screendata/Foolish8Rev",desc:"An inside look at the Motley Fool's small-cap screen and the recent revisions they've made to update the screen."}:"Kirkpatrick Bargain"==e?t={url:"http://www.aaii.com/stock-screens/screendata/KirkpatrickBargain",desc:"Investing model outlined in Charles Kirkpatrick's book Beat the Market: Invest by Knowing What Stocks to Buy and What Stocks to Sell."}:"Kirkpatrick Value"==e?t={url:"http://www.aaii.com/stock-screens/screendata/KirkpatrickValue",desc:"Investing model outlined in Charles Kirkpatrick's book Beat the Market: Invest by Knowing What Stocks to Buy and What Stocks to Sell."}:"Lynch"==e?t={url:"http://www.aaii.com/stock-screens/screendata/Lynch",desc:"A strictly bottom-up approach, focusing on companies familiar to the investor."}:"Murphy Technology"==e?t={url:"http://www.aaii.com/stock-screens/screendata/Murphy",desc:"An approach that identifies technology stocks with high R&D spending, strong margins and Growth, but selling at attractive Values."}:"Neff"==e?t={url:"http://www.aaii.com/stock-screens/screendata/Neff",desc:"An approach using a stringent contrarian viewpoint—finding underValued, out-of-favor stocks in the bargain basement that have an optimistic future."}:"Price-to-Sales"==e?t={url:"http://www.aaii.com/stock-screens/screendata/PricetoSales",desc:"Research indicates that using price-to-sales ratios may lead to better investment results than price-to-book-Value ratios or price-earnings ratios."}:"Rule #1 Investing"==e?t={url:"http://www.aaii.com/stock-screens/screendata/Rule1",desc:"Adapted from Phil Town's book Rule #1, this screen attempts to identify wonderful companies with attractive prices."}:"T. Rowe Price"==e?t={url:"http://www.aaii.com/stock-screens/screendata/TRowePrice",desc:"Price's long-standing approach focus's on Growth stocks but avoids over glamorized stocks."}:"Templeton"==e?t={url:"http://www.aaii.com/stock-screens/screendata/Templeton",desc:"Looks for favorable margins, consistent earnings Growth and price-earnings ratios below historic norms."}:"Wanger (Revised)"==e?t={url:"http://www.aaii.com/stock-screens/screendata/Wanger",desc:"First introduced in May 1997, this approach focuses on limiting the risks of investing in small-cap stocks."}:"Zweig"==e?t={url:"http://www.aaii.com/stock-screens/screendata/Zweig",desc:"A strategy that identifies companies with strong Growth, a reasonable price-earnings ratio given the company's Growth rate."}:"ADR Screen"==e?t={url:"http://www.aaii.com/stock-screens/screendata/ADRs",desc:"An ADR stock screen seeks out foreign companies with attractive PEG ratios and increasing price strength."}:"MAGNET Complex"==e?t={url:"http://www.aaii.com/stock-screens/screendata/MAGNETComplex",desc:"These two blend Value, Growth and momentum investing styles into a single stock selection model."}:"MAGNET Simple"==e?t={url:"http://www.aaii.com/stock-screens/screendata/MAGNETSimple",desc:"These two blend Value, Growth and momentum investing styles into a single stock selection model."}:"Muhlenkamp"==e?t={url:"http://www.aaii.com/stock-screens/screendata/Muhlenkamp",desc:"Muhlenkamp uses a bottom-up approach to selecting stocks, but adjusts his benchmarks based upon the broad economic environment…"}:"Oberweis Octagon"==e?t={url:"http://www.aaii.com/stock-screens/screendata/Oberweis",desc:"Management seeks out rapidly growing companies and invests in those they feel are attractively priced."}:"Stock Market Winners"==e?t={url:"http://www.aaii.com/stock-screens/screendata/Winners",desc:"A screen that tries to interpret and apply successful trading rules in the real market environment."}:"Value on the Move--PEG With Est Growth"==e?t={url:"http://www.aaii.com/stock-screens/screendata/ValueEstGrowth",desc:"Using PEG ratios and price strength to find Growth stocks trading a reasonable price."}:"Value on the Move--PEG With Hist Growth"==e?t={url:"http://www.aaii.com/stock-screens/screendata/ValueHistGrowth",desc:"Using PEG ratios and price strength to find Growth stocks trading a reasonable price."}:"Dreman With Est Revisions"==e?t={url:"http://www.aaii.com/stock-screens/screendata/DremanWithEstRev",desc:"Utilizing contrarian stocks with upward earnings revisions."}:"Est Rev: Down"==e||("Est Rev: Down 5%"==e?t={url:"http://www.aaii.com/stock-screens/screendata/EstRevDown5",desc:"Introduction to the use of earnings estimates."}:"Est Rev: Up 20.7"==e||("Est Rev: Up 5%"==e?t={url:"http://www.aaii.com/stock-screens/screendata/EstRevUp5",desc:"Introduction to the use of earnings estimates."}:"Est Rev: Top 30 Up"==e?t={url:"http://www.aaii.com/stock-screens/screendata/EstRevUp",desc:"Introduction to the use of earnings estimates."}:"Est Rev: Lowest 30 Down"==e?t={url:"http://www.aaii.com/stock-screens/screendata/EstRevDown",desc:"Introduction to the use of earnings estimates."}:"P/E Relative"==e?t={url:"http://www.aaii.com/stock-screens/screendata/PERelative",desc:"A closely followed screen that looks back at the different relationships of the price-earnings ratio of a stock."}:"Insider Net Purchases"==e&&(t={url:"http://www.aaii.com/stock-screens/screendata/Insider",desc:"Who insiders are, what requirements they must obey, and what insider data is important."})))),t},y=function(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},S=function(e){return e=e.replace("price chg",""),e=y(e),"Cash Rich Firms"==e||"Dogs of the Dow"==e||"Fundamental Rule of Thumb"==e||"Graham--Defensive Investor (Non-Utility)"==e||"Graham--Defensive Investor (Utility)"==e||"Graham--Enterprising Investor"==e||"Graham--Enterprising Investor Revised"==e||"Magic Formula"==e||"O'Shaughnessy: Value"==e||"Piotroski: High F-Score (8)"==e||"Piotroski 9"==e||"Price-to-Free-Cash-Flow"==e||"Schloss"==e||"Dogs of the Dow: Low Priced 5"==e||"Shadow Stock Screen"==e||"Weiss Blue Chip Div Yield"==e?"Value":"Lakonishok"==e||"O'Shaughnessy: All Cap"==e||"O'Shaughnessy: Growth"==e||"O'Shaughnessy: Growth Market Leaders"==e||"O'Shaughnessy: Small Cap Growth & Value"==e||"O'Shaughnessy: Tiny Titans"==e?"Value With Price Momentum":"Dual Cash Flow"==e||"IBD Stable 70"==e||"Inve$tWare Quality Growth"==e||"Return on Equity"==e?"Growth":"Driehaus"==e||"Foolish Small Cap 8"==e||"Kirkpatrick Growth"==e||"O'Neil's CAN SLIM"==e||"O'Neil's CAN SLIM No Float"==e||"O'Neil's CAN SLIM Revised 3rd Edition"==e?"Growth With Price Momentum":"Buffett: Hagstrom"==e||"Buffettology: EPS Growth"==e||"Buffettology: Sustainable Growth"==e||"Dividend (High Relative Yield)"==e||"Dividend Screen: DRPs"==e||"Dividend Screen: Non-DRPs"==e||"Dreman"==e||"Fisher (Philip)"==e||"Foolish Small Cap 8 Revised"==e||"Kirkpatrick Bargain"==e||"Kirkpatrick Value"==e||"Lynch"==e||"Murphy Technology"==e||"Neff"==e||"Price-to-Sales"==e||"Rule #1 Investing"==e||"T. Rowe Price"==e||"Templeton"==e||"Wanger (Revised)"==e||"Zweig"==e?"Growth & Value":"ADR Screen"==e||"MAGNET Complex"==e||"MAGNET Simple"==e||"Muhlenkamp"==e||"Oberweis Octagon"==e||"Stock Market Winners"==e||"Value on the Move--PEG With Est Growth"==e||"Value on the Move--PEG With Hist Growth"==e?"Growth & Value With Price Momentum":"Dreman With Est Revisions"==e||"Est Rev: Down"==e||"Est Rev: Down 5%"==e||"Est Rev: Up 20.7"==e||"Est Rev: Up 5%"==e||"Est Rev: Top 30 Up"==e||"Est Rev: Lowest 30 Down"==e||"P/E Relative"==e?"Earnings Estimates":"All Exchange-Listed Stocks"==e||"All ADRs"==e||"S&P SmallCap 600 Growth (TR)"==e||"S&P MidCap 400 Value (TR)"==e||"S&P SmallCap 600 (TR)"==e||"S&P 500 Growth (TR)"==e||"S&P SmallCap 600 Value (TR)"==e||"S&P 500 (TR)"==e||"S&P MidCap 400 (TR)"==e||"S&P 500 Value (TR)"==e||"S&P SmallCap 600"==e||"S&P MidCap 400 Growth (TR)"==e||"NASDAQ 100"==e||"S&P MidCap 400"==e||"Dow Jones 30"==e||"S&P 500"==e?"Indexes":"T-Bills"==e?"T-Bills":"Insider Net Purchases"==e?"Insider Net Purchases":""},R=function(e){e=y(e);var t={"S&P 500 price chg":[0],"S&P MidCap 400 price chg":[0],"S&P SmallCap 600 price chg":[0],"NASDAQ 100 price chg":[0],"Dow Jones 30 price chg":[0],"T-Bills price chg":[0],"S&P 500 (TR)":[0],"S&P 500 Growth (TR)":[0],"S&P 500 Value (TR)":[0],"S&P MidCap 400 (TR)":[0],"S&P MidCap 400 Growth (TR)":[0],"S&P MidCap 400 Value (TR)":[0],"S&P SmallCap 600 (TR)":[0],"S&P SmallCap 600 Growth (TR)":[0],"S&P SmallCap 600 Value (TR)":[0],"All Exchange-Listed Stocks price chg":[0],"ADR Screen price chg":["44%"],"All ADRs price chg":[0],"Buffett: Hagstrom price chg":["20%"],"Buffettology: EPS Growth price chg":["12%"],"Buffettology: Sustainable Growth price chg":["13%"],"O'Neil's CAN SLIM price chg":["#DIV/0!"],"O'Neil's CAN SLIM Revised 3rd Edition price chg":["35%"],"O'Neil's CAN SLIM No Float price chg":["0%"],"Cash Rich Firms price chg":["25%"],"Dual Cash Flow price chg":["31%"],"Dividend (High Relative Yield) price chg":["20%"],"Dogs of the Dow price chg":["7%"],"Dogs of the Dow: Low Priced 5 price chg":["16%"],"Dreman price chg":["32%"],"Dreman With Est Revisions price chg":["65%"],"Driehaus price chg":["63%"],"Dividend Screen: DRPs price chg":["26%"],"Dividend Screen: Non-DRPs price chg":["28%"],"Est Rev: Lowest 30 Down  price chg":["91%"],"Est Rev: Down 5% price chg":["89%"],"Est Rev: Top 30 Up price chg":["93%"],"Est Rev: Up 5% price chg":["92%"],"Fisher (Philip) price chg":["33%"],"Foolish Small Cap 8 price chg":["40%"],"Foolish Small Cap 8 Revised price chg":["34%"],"Price-to-Free-Cash-Flow price chg":["22%"],"Fundamental Rule of Thumb price chg":["21%"],"Graham--Defensive Investor (Non-Utility) price chg":["20%"],"Graham--Defensive Investor (Utility) price chg":["14%"],"Graham--Enterprising Investor price chg":["45%"],"Graham--Enterprising Investor Revised price chg":["100%"],"IBD Stable 70 price chg":["12%"],"Insider Net Purchases price chg":["30%"],"Inve$tWare Quality Growth price chg":["11%"],"Kirkpatrick Bargain price chg":["64%"],"Kirkpatrick Growth price chg":["62%"],"Kirkpatrick Value price chg":["74%"],"Lakonishok price chg":["90%"],"Lynch price chg":["21%"],"Magic Formula  price chg":["24%"],"MAGNET Complex price chg":["74%"],"MAGNET Simple price chg":["67%"],"Muhlenkamp price chg":["24%"],"Murphy Technology price chg":["21%"],"Neff price chg":["33%"],"O'Shaughnessy: All Cap price chg":["49%"],"O'Shaughnessy: Growth Market Leaders price chg":["43%"],"O'Shaughnessy: Growth price chg":["38%"],"O'Shaughnessy: Small Cap Growth & Value price chg":["49%"],"O'Shaughnessy: Tiny Titans price chg":["42%"],"O'Shaughnessy: Value price chg":["21%"],"Oberweis Octagon price chg":["42%"],"P/E Relative price chg":["77%"],"Value on the Move--PEG With Est Growth price chg":["45%"],"Value on the Move--PEG With Hist Growth price chg":["36%"],"Piotroski: High F-Score (8) price chg":["24%"],"Piotroski 9 price chg":["#DIV/0!"],"Price-to-Sales price chg":["39%"],"Return on Equity price chg":["21%"],"Rule #1 Investing price chg":["25%"],"Schloss price chg":["55%"],"Shadow Stock Screen price chg":["35%"],"T. Rowe Price price chg":["40%"],"Templeton price chg":["28%"],"Wanger (Revised) price chg":["27%"],"Weiss Blue Chip Div Yield price chg":["25%"],"Stock Market Winners price chg":["59%"],"Zweig price chg":["42%"]};return t[e]},D=function(e){var t;switch(e){case 0:t="Jan";break;case 1:t="Feb";break;case 2:t="Mar";break;case 3:t="Apr";break;case 4:t="May";break;case 5:t="Jun";break;case 6:t="Jul";break;case 7:t="Aug";break;case 8:t="Sep";break;case 9:t="Oct";break;case 10:t="Nov";break;case 11:t="Dec"}return t},b=function(e,t){for(var r=D(t.getMonth())+" "+t.getFullYear(),a=0;a<e.length;a++)if(e[a].month==r)return a;return-1},A=function(e,t){var r=b(l,e),a=b(l,t);return-1>=r||-1>=a?void 0:l.slice(r,a+1)},G=function(e,t){var r=(o-40)/t;f="";var a=d3.select("#categories-chart").append("svg").attr("height",50).attr("width",o),s=0;a.selectAll("rect").data(e).enter().append("rect").attr("category",function(e){return e.key}).attr("x",function(e){var t=s,a=Math.floor(r*e.value);return s+=a,t}).attr("y",7).attr("width",function(e){var t=Math.floor(r*e.value);return t}).attr("height",25).style("fill",function(e){return""!=e?""===f||f===e.key?d3.rgb(i[e.key]):d3.rgb(i[e.key]).darker(1.75):void 0}).on("click",function(e){f=e.key,d3.select("#categories-chart").select(".reset").style("display",null),m.filter(f).top(t),C(m,t),dc.renderAll()}).on("mouseover",function(){d3.select(this).style("cursor","pointer")}),$("rect").popover({container:"body",trigger:"hover",placement:"top",content:function(){return d3.select(this).attr("category")}})},C=function(e,t){var r=(o-40)/t,a=0,s=d3.select("#categories-chart");s.selectAll("rect").data(e).transition().duration(150).attr("x",function(e){var t=a,s=Math.floor(r*e.value);return a+=s,t}).attr("y",7).attr("width",function(e){var t=Math.floor(r*e.value);return t}).attr("height",25).attr("category",function(e){return e.key}).style("fill",function(e){return""!=e?""===f||f===e.key?d3.rgb(i[e.key]):d3.rgb(i[e.key]).darker(1.75):void 0}),$("rect").popover({container:"body",trigger:"hover",placement:"top",content:function(){return d3.select(this).attr("category")}})},M=function(e){var i=crossfilter(e),l=i.groupAll();d=i.dimension(function(e){return Math.ceil(e.annualizedReturn)});var f=d.group();u=i.dimension(function(e){return Math.ceil(parseFloat(e.sharpeRatio))});var v=u.group();p=i.dimension(function(e){return Math.ceil(parseFloat(e.stdDev))});var k=p.group();m=i.dimension(function(e){return""!=e.screenType?e.screenType:void 0});var y=m.group();g=i.dimension(function(e){return parseFloat(e.riskIdx)});var S=g.group(),R=9999;w=i.dimension(function(e){return isNaN(parseFloat(e.turnover))?R++:Math.ceil(parseFloat(e.turnover))});var D=w.group(),b=170,A=o/5-10;110>A&&(A=260);var M={top:10,right:20,bottom:40,left:20},P=d3.extent(e,function(e){return Math.ceil(parseFloat(e.sharpeRatio))});x=(P[1]-P[0])/20,s.width(A).height(b).margins(M).dimension(u).group(v).transitionDuration(350).centerBar(!0).gap(1).round(dc.round.floor).x(d3.scale.linear().domain([P[0]-x,P[1]+x])).renderHorizontalGridLines(!0).xAxis().ticks(4).tickFormat(function(e){return e+"%"});var F=d3.extent(e,function(e){return Math.ceil(parseFloat(e.stdDev))});x=(F[1]-F[0])/20,a.width(A).height(b).margins(M).dimension(p).group(k).transitionDuration(350).centerBar(!0).gap(1).round(dc.round.floor).x(d3.scale.linear().domain([F[0]-x,F[1]+x])).xUnits(function(){return 30}).renderHorizontalGridLines(!0).xAxis().ticks(4).tickFormat(function(e){return e+"%"});var T=d3.extent(e,function(e){return parseFloat(e.riskIdx)});x=.1,c?r.width(A).height(b).margins(M).dimension(g).group(S).transitionDuration(350).centerBar(!0).gap(5).x(d3.scale.linear().domain([T[0]-x,T[1]+x])).xUnits(dc.units.float.precision(.1)).renderHorizontalGridLines(!0).xAxis().ticks(4):r.width(A).height(b).margins(M).dimension(g).group(S).transitionDuration(350).centerBar(!0).gap(5).x(d3.scale.linear().domain([T[0]-x,T[1]+x])).filter([1,1.75]).xUnits(dc.units.float.precision(.1)).renderHorizontalGridLines(!0).xAxis().ticks(4);var I=d3.extent(e,function(e){return Math.ceil(parseFloat(e.turnover))});x=(I[1]-I[0])/20,n.width(A).height(b).margins(M).dimension(w).group(D).centerBar(!0).gap(5).round(dc.round.floor).x(d3.scale.linear().domain([I[0]-x,I[1]+x])).xUnits(function(){return 30}).renderHorizontalGridLines(!0).xAxis().ticks(4).tickFormat(function(e){return e+"%"});var E=d3.extent(e,function(e){return Math.ceil(e.annualizedReturn)}),x=(d3.scale.quantize().domain([E[0],E[1]]),(E[1]-E[0])/20);c?t.width(A).height(b).margins(M).dimension(d).group(f).transitionDuration(350).centerBar(!0).gap(1).round(dc.round.floor).x(d3.scale.linear().domain([E[0]-x,E[1]+x])).renderHorizontalGridLines(!0).xAxis().ticks(5).tickFormat(function(e){return e+"%"}):t.width(A).height(b).margins(M).dimension(d).group(f).transitionDuration(350).centerBar(!0).gap(1).round(dc.round.floor).x(d3.scale.linear().domain([E[0]-x,E[1]+x])).filter([5,25]).renderHorizontalGridLines(!0).xAxis().ticks(5).tickFormat(function(e){return e+"%"}),dc.dataCount(".dc-data-count").dimension(i).group(l),dc.renderAll(),r.renderlet(function(){c?(C(y.all(),e.length),"Annualized Return"===h?K(d.top(e.length)):"Sharpe Ratio"===h?K(u.top(e.length)):"Std Deviation"===h?K(p.top(e.length)):"Risk Index"===h?K(g.top(e.length)):"Average Turnover"===h&&K(w.top(e.length))):(G(y.all(),e.length),J(d.top(e.length)),c=!0)}),window.onresize=function(){if(o=$("#wrapper").width(),C(y.all(),e.length),$("#latch").hasClass("closed")){var t=document.getElementById("slidingdiv").offsetWidth-35;$("#slidingdiv").animate({right:t},0)}}},P=function(e){for(var t=1,r=e.length,a=0;r>a;a++)t*=(parseFloat(e[a])/100+1).toFixed(2);var s=100*(Math.pow(t,12/r)-1);return(v||!c)&&(document.getElementById("returnsLabel").innerHTML='<span>Annualized Return </span><a class="reset" href="javascript:aaiiScreener.returnsChart.filterAll();dc.redrawAll();" style="display: none;">reset</a>',v=!1),s.toFixed(2)},F=function(e){for(var t=1,r=0;r<e.length;r++)t*=(parseFloat(e[r])/100+1).toFixed(2);var a=100*(t-1);return v||(document.getElementById("returnsLabel").innerHTML='<span>Cummulative Return </span><a class="reset" href="javascript:aaiiScreener.returnsChart.filterAll();dc.redrawAll();" style="display: none;">reset</a>',v=!0),a.toFixed(2)},T=function(e){var t=new ps.array(e);return t.stdDev().toFixed(2)},I=function(e,t){return(e/t).toFixed(2)},E=function(e,t){for(var r=e.length,a=0,s=0;r>s;s++)a+=e[s]-t[s];return 1*a/r},x=function(e,t,r){for(var a=e.length,s=0,n=0;a>n;n++)s+=Math.pow(e[n]-t[n]-r,2);return Math.sqrt(1*s/(a-1))},N=function(e,t){var r=E(e,t),a=x(e,t,r);return(100*r/a).toFixed(2)},B=function(e,t){var r=A(e,t),a=[];for(var s in r[0])if(r[0].hasOwnProperty(s)&&"month"!=s){for(var n=[],i=0;i<r.length;i++)n.push(parseFloat(r[i][s]));a[s]=n}var o,c=[],l=[],h="S&P 500 price chg";o=r.length>=12?P(a[h]):F(a[h]);var d=N(a[h],a["T-Bills price chg"]),u=T(a[h]),p=parseFloat(R(h));l.push({screen:h.replace("price chg","")}),l.push({screenType:S(h)}),l.push({annualizedReturn:o}),l.push({stdDev:u}),l.push({riskIdx:1..toFixed(2)}),l.push({sharpeRatio:d}),l.push({turnover:p}),c.push({screen:h,screenType:S(h),annualizedReturn:o,stdDev:u,riskIdx:1..toFixed(2),sharpeRatio:d,turnover:p,stats:l});for(var s in r[0])if(r[0].hasOwnProperty(s)&&"month"!==s&&s!==h){o=r.length>=12?P(a[s]):F(a[s]),d="T-Bills price chg"==s?0:N(a[s],a["T-Bills price chg"]);var g=T(a[s]);p=parseFloat(R(s)),l=[],l.push({screen:s.replace("price chg","")}),l.push({screenType:S(s)}),l.push({annualizedReturn:o}),l.push({stdDev:g}),l.push({riskIdx:I(g,u)}),l.push({sharpeRatio:d}),l.push({turnover:p}),c.push({screen:s,screenType:S(s),annualizedReturn:o,stdDev:g,riskIdx:I(g,u),sharpeRatio:d,turnover:p,stats:l})}M(c)},O=function(){m.filterAll(),f="",d3.select("#categories-chart").select(".reset").style("display","none")},V=function(){t.filterAll(),r.filterAll(),a.filterAll(),s.filterAll(),n.filterAll(),O(),U()},L=function(t){var r=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec"],a=new Date;a.setDate(15),a.setMonth(e.getMonth()-60),$("#time-range-selector").dateRangeSlider({bounds:{min:t,max:e},defaultValues:{min:a,max:e},range:{min:{months:1}},formatter:function(e){var t=r[e.getMonth()],a=e.getFullYear();return t+" "+a}}),$("#time-range-selector").dateRangeSlider({valueLabels:"show",arrows:!1,step:{months:1}}),$("#time-range-selector").bind("valuesChanged",function(e,t){c&&(V(),B(t.values.min,t.values.max))})},W=function(e,t){$("#time-range-selector").dateRangeSlider("values",e,t)},z=function(e,t){W(e,t)},H=function(t){var r=new Date(e);r.setDate(15),r.setMonth(e.getMonth()-t+1),z(r,e),c||B(r,e)},U=function(){var e=d3.select("body");e.select("#stats").remove()},K=function(e){U(),J(e)},J=function(e){var t="100px",r="50px",a=[];a.push("Strategy Name"),a.push("Category"),a.push(v?"Cummulative Return":"Annualized Return"),a.push("Std Deviation"),a.push("Risk Index"),a.push("Sharpe Ratio"),a.push("Average Turnover");{var s=d3.select("#stats-table").style("overflow-y","scroll").append("table").style("class","table-bordered").style("table-layout","fixed").style("width","100%").style("border-collapse","collapse").style("border","1px black solid").attr("id","stats"),n=s.append("thead");n.append("tr").selectAll("th").data(a).enter().append("th").style("width",function(e,a){return 2>a?t:r}).style("border","1px #aaaaaa solid").style("padding","5px").text(function(e){return e}).style("font-size","10px").style("color",function(e,t){var r="#9003CD";return 2>t?"black":"Annualized Return"!==h&&"Cummulative Return"!==h||2!=t?"Std Deviation"===h&&3==t?r:"Risk Index"===h&&4==t?r:"Sharpe Ratio"===h&&5==t?r:"Average Turnover"===h&&6==t?r:"blue":r}).style("text-align","center").on("mouseover",function(e,t){t>1&&d3.select(this).style("cursor","pointer")}).on("click",function(e,t){t>1&&(h=e),"Annualized Return"===h||"Cummulative Return"===h?K(d.top(l.length)):"Sharpe Ratio"===h?K(u.top(l.length)):"Std Deviation"===h?K(p.top(l.length)):"Risk Index"===h?K(g.top(l.length)):"Average Turnover"===h&&K(w.top(l.length))}),s.append("tbody").selectAll("tr").data(e).enter().append("tr").on("mouseover",function(){d3.select(this).style("background-color","aliceblue")}).on("mouseout",function(e){d3.select(this).style("background-color",d3.rgb(i[e.screenType]))}).style("background-color",function(e){return d3.rgb(i[e.screenType])}).attr("screen",function(e){return e.screen}).attr("screenType",function(e){return e.screenType}).selectAll("td").data(function(e){return e.stats}).enter().append("td").style("white-space","nowrap").style("overflow","hidden").style("border","1px #aaaaaa solid").style("padding","1px").style("width",function(e,a){return 2>a?t:r}).text(function(e,t){return 0==t?e.screen:1==t?e.screenType:2==t?e.annualizedReturn:3==t?e.stdDev:4==t?e.riskIdx:5==t?e.sharpeRatio:6==t?e.turnover:void 0}).on("click",function(e,t){var r=k(e.screen);0==t&&"undefined"!=typeof r&&window.open(r.url,"targetWindow")}).style("font-size","10px").style("color",function(e,t){var r=d3.select(this.parentNode).attr("screen"),a=k(r);return 0==t&&"undefined"!=typeof a?"blue":"black"}).style("text-align",function(e,t){return 2>t?"left":"center"}).on("mouseover",function(e,t){var r=d3.select(this.parentNode).attr("screen"),a=k(r);0==t&&"undefined"!=typeof a&&d3.select(this).style("cursor","pointer")})}$("table tr td:nth-child(1)").popover({container:"body",trigger:"hover",placement:"top",html:!0,title:function(){return d3.select(this.parentNode).attr("screen").replace("price chg","")},content:function(){var e=d3.select(this.parentNode).attr("screen"),t=k(e);if("undefined"!=typeof t){var r=t.desc;return r}return""}})};return function(){d3.csv("data/monthlyperformance-cleaned-apr2015.csv",function(t){l=t;var r=l[0].month.split(" "),a=r[1],s=r[0],n=new Date(s+" 1, "+a+" 00:00:00"),i=new Date(n.getFullYear(),n.getMonth(),1);i.setDate(15);var o=l[l.length-1].month.split(" "),c=o[1],h=o[0],d=new Date(h+" 1, "+c+" 00:00:00");e=new Date(d.getFullYear(),d.getMonth()+1,0),e.setDate(15),L(i),H(60)})}(),{setTimeRange:z,setRelativeTimeRange:H,resetScreenCategory:O,returnsChart:t,riskIdxChart:r,stdDevChart:a,sharpeRatioChart:s,turnoverChart:n}}();